
  0%|                                                                                                         | 0/15 [00:00<?, ?it/s]
Train Epoch: 0 	Graphs_seen: 0.0% 	Loss: 108.558136
Train Epoch: 0 	Graphs_seen: 6.82% 	Loss: 105.186462
Train Epoch: 0 	Graphs_seen: 13.65% 	Loss: 104.303780
Train Epoch: 0 	Graphs_seen: 20.47% 	Loss: 103.862350
Train Epoch: 0 	Graphs_seen: 27.29% 	Loss: 103.470528
Train Epoch: 0 	Graphs_seen: 34.12% 	Loss: 101.743950
Train Epoch: 0 	Graphs_seen: 40.94% 	Loss: 104.882431
Train Epoch: 0 	Graphs_seen: 47.76% 	Loss: 102.744476
Train Epoch: 0 	Graphs_seen: 54.58% 	Loss: 101.295639

  7%|██████▍                                                                                          | 1/15 [01:08<15:52, 68.01s/it]
Test set: Average loss: 1.6120, Accuracy: 10898.0/2012400856.0 (0%)
Train Epoch: 1 	Graphs_seen: 0.0% 	Loss: 100.638885
Train Epoch: 1 	Graphs_seen: 6.82% 	Loss: 101.594559
Train Epoch: 1 	Graphs_seen: 13.65% 	Loss: 106.437378
Train Epoch: 1 	Graphs_seen: 20.47% 	Loss: 104.463707
Train Epoch: 1 	Graphs_seen: 27.29% 	Loss: 101.335060
Train Epoch: 1 	Graphs_seen: 34.12% 	Loss: 104.471024
Train Epoch: 1 	Graphs_seen: 40.94% 	Loss: 102.128822
Train Epoch: 1 	Graphs_seen: 47.76% 	Loss: 104.328781
Train Epoch: 1 	Graphs_seen: 54.58% 	Loss: 104.652954
Train Epoch: 1 	Graphs_seen: 61.41% 	Loss: 104.905952

 13%|████████████▉                                                                                    | 2/15 [02:16<14:44, 68.06s/it]
Train Epoch: 2 	Graphs_seen: 0.0% 	Loss: 101.118202
Train Epoch: 2 	Graphs_seen: 6.82% 	Loss: 103.571915
Train Epoch: 2 	Graphs_seen: 13.65% 	Loss: 100.261444
Train Epoch: 2 	Graphs_seen: 20.47% 	Loss: 101.302223
Train Epoch: 2 	Graphs_seen: 27.29% 	Loss: 103.397507
Train Epoch: 2 	Graphs_seen: 34.12% 	Loss: 101.014938
Train Epoch: 2 	Graphs_seen: 40.94% 	Loss: 98.140923
Train Epoch: 2 	Graphs_seen: 47.76% 	Loss: 101.870583
Train Epoch: 2 	Graphs_seen: 54.58% 	Loss: 104.125351

 20%|███████████████████▍                                                                             | 3/15 [03:24<13:41, 68.43s/it]
Test set: Average loss: 1.6177, Accuracy: 10746.0/2012400856.0 (0%)
Train Epoch: 3 	Graphs_seen: 0.0% 	Loss: 101.926231
Train Epoch: 3 	Graphs_seen: 6.82% 	Loss: 103.418961
Train Epoch: 3 	Graphs_seen: 13.65% 	Loss: 102.735703
Train Epoch: 3 	Graphs_seen: 20.47% 	Loss: 102.092461
Train Epoch: 3 	Graphs_seen: 27.29% 	Loss: 105.618065
Train Epoch: 3 	Graphs_seen: 34.12% 	Loss: 103.320534
Train Epoch: 3 	Graphs_seen: 40.94% 	Loss: 103.775108
Train Epoch: 3 	Graphs_seen: 47.76% 	Loss: 104.403137
Train Epoch: 3 	Graphs_seen: 54.58% 	Loss: 105.778061

 27%|█████████████████████████▊                                                                       | 4/15 [04:32<12:29, 68.16s/it]
Test set: Average loss: 1.6176, Accuracy: 10759.0/2012400856.0 (0%)
Train Epoch: 4 	Graphs_seen: 0.0% 	Loss: 104.675179
Train Epoch: 4 	Graphs_seen: 6.82% 	Loss: 103.123909
Train Epoch: 4 	Graphs_seen: 13.65% 	Loss: 104.762352
 27%|█████████████████████████▊                                                                       | 4/15 [05:00<13:47, 75.25s/it]
Traceback (most recent call last):
  File "/home/nbiescas/Desktop/CVC/CVC_internship/main.py", line 29, in <module>
    model_pipeline(model, train_loader, val_loader, test_loader)
  File "/home/nbiescas/Desktop/CVC/CVC_internship/training.py", line 99, in model_pipeline
    train_loss = train(epoch, criterion, model, optimizer, train_loader)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nbiescas/Desktop/CVC/CVC_internship/training.py", line 67, in train
    for batch_idx, (graph, adjacency_matrices_target) in enumerate(loader):
  File "/home/nbiescas/miniconda3/envs/CVC/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/home/nbiescas/miniconda3/envs/CVC/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 677, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nbiescas/miniconda3/envs/CVC/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/nbiescas/Desktop/CVC/CVC_internship/Data_Loaders.py", line 16, in collate
    removed_edges = list(map(partial_removed_edges, graphs))
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nbiescas/Desktop/CVC/CVC_internship/d_preprocess.py", line 15, in random_remove_edges
    return dgl.remove_edges(dgl_graph, edges_to_remove)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nbiescas/miniconda3/envs/CVC/lib/python3.11/site-packages/dgl/transforms/functional.py", line 1819, in remove_edges
    g.remove_edges(eids, etype=etype, store_ids=store_ids)
  File "/home/nbiescas/miniconda3/envs/CVC/lib/python3.11/site-packages/dgl/heterograph.py", line 718, in remove_edges
    F.max(eids, dim=0)
  File "/home/nbiescas/miniconda3/envs/CVC/lib/python3.11/site-packages/dgl/backend/pytorch/tensor.py", line 177, in max
    return th.max(input, dim=dim)[0]
           ^^^^^^^^^^^^^^^^^^^^^^
